<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>Message</title>
</head>
<body>
<input type='button' value="生日快乐"
	onclick="publishMsg('birth-day.mp3');" />
<input type='button' value="生日快乐"
	onclick="publishMsg('birth-dayta.mp3');" />
<input type='button' value="K歌之王"
	onclick="publishMsg('eason-king.mp3');" />
<input type='button' value="十年"
	onclick="publishMsg('tenyear.mp3');" />
<input type='button' value="兄弟"
	onclick="publishMsg('brother.mp3');" />
<input type='button' value="DJ"
	onclick="publishMsg('dj.flv');" />
<input type='button' value="漂亮女生"
	onclick="publishMsg('ol1.flv');" />
<div id="contentDiv"></div>
<div id="msgContainer"></div>
</body>
<script src="/app/bootstrap/jquery-1.7.1.min.js" type="text/javascript"></script>
<script src="/app/bootstrap/common.js" type="text/javascript"></script>
<script src="/app/bootstrap/event.js" type="text/javascript"></script>
<script type="text/javascript">
var dk = new DK({url:'/event'});
var dele=$('#contentDiv');
var msgEl=$('#msgContainer');
$(document).ready(function() {
    $(window).unload(function () {
        dk.leave();
    });
 
    dk.join("player", {label: "all",user:"test"}, function(id) {
    	dele.text("join:"+id);      
    });
});

function publishMsg(msg){
	var time = new Date().format("yyyy-MM-dd hh:mm:ss");
	dk.publish("msgPage", "player", msg, time, function(s) {
        if (s == 0) {
        	msgEl.append('发送msg成功,'+msg+'<br/>');
        }
    });
}
</script>
</html>
